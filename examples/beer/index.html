<!DOCTYPE html>
<html>
    <head>
        <title>Pixfinder - a JavaScript library for image analysis</title>
        <meta charset="utf-8" />
        <script src="../../src/Pixfinder.js"></script>
        <script src="../../src/Util/Util.js"></script>
        <script src="../../src/Util/Color.js"></script>
        <script src="../../src/Util/Math.js"></script>
        <script src="../../src/Struct/Struct.js"></script>
        <script src="../../src/Struct/DisjointSet.js"></script>
    </head>
    <body>
        <p>
        What kinds of beer on the photo?<br />
        Pixfinder analyzed this image and signed each glass!
        </p>
        <img id="myImg" width="600" height="400" src="img.jpg" crossOrigin="Anonymous"></img>
        <canvas style="position:relative; left:-600px" id="canv" width="600" height="400" style="border:1px solid #d3d3d3;"></canvas>
        <p>Photo is &copy; <a target="_blank" href="http://500px.com/photo/5114123">Ed Dorroh</a></p>
        <script>
            window.onload = function () {
                var myImg = document.getElementById('myImg');
                var beerTypes = {
                    '000000': 'Stout!',
                    '3b0000': 'Dark Ale!',
                    'de5100': 'Golden Ale!',
                    'b87400': 'Wheat Beer!'
                }

                for (var color in beerTypes) {
                    var p = pixfinder({
                        img: myImg,
                        colors: [color],
                        tolerance: 5,
                        onload: function(e) {
                            var shape = []; // find glass (because we have some noise in results)
                            for (var i = 0; i < e.edges.length; i++) {
                                if (e.edges[i].length > shape.length) {
                                    shape = e.edges[i];
                                }
                            };
                            
                            var lastShapePx = shape[shape.length-1];
                            var c = document.getElementById("canv");
                            var ctx = c.getContext("2d");
                            ctx.font = "italic 12pt Tahoma";
                            ctx.fillText(beerTypes[color], lastShapePx.x-50, lastShapePx.y-100);
                        }
                    });
                };
            }
        </script>
    </body>
</html>