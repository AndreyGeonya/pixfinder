<!DOCTYPE html>
<html>
    <head>
        <title>Pixfinder - a JavaScript library for image analysis</title>
        <meta charset="utf-8" />
        <script src="../../src/Pixfinder.js"></script>
        <script src="../../src/Util/Util.js"></script>
        <script src="../../src/Util/Color.js"></script>
        <script src="../../src/Util/Math.js"></script>
        <script src="../../src/Struct/Struct.js"></script>
        <script src="../../src/Struct/DisjointSet.js"></script>
    </head>
    <body>
        <p>
        How many balloons in the sky?<br />
        Pixfinder analyzed this image and thinks that there are <b id="count"></b> balloons!
        </p>
        <img id="myImg" width="512" height="512" src="img.jpg" crossOrigin="Anonymous"></img>
        <canvas id="canv" width="512" height="512" style="border:1px solid #d3d3d3;"></canvas>
        <p>Photo: &copy; <a target="_blank" href="http://500px.com/photo/37629346">Tamás Mészáros</a></p>
        <script>
            window.onload = function () {
                var myImg = document.getElementById('myImg');
                var p = pixfinder({
                    img: myImg,
                    colors: ['e31461'],
                    distance: 10,
                    tolerance: 100,
                    accuracy: 3,
                    onload: drawGeometries
                });

                function drawGeometries(e) {
                    document.getElementById('count').innerHTML = e.edges.length;

                    var c=document.getElementById("canv");
                    var ctx=c.getContext("2d");
                    for (var i = 0; i < e.edges.length; i++) {
                        ctx.fillStyle = Pixfinder.Util.Color.toHex ([
                            Math.random() * 255,
                            Math.random() * 255,
                            Math.random() * 255
                        ]);
                        ctx.beginPath();
                        for (var j = 0; j < e.edges[i].length; j++) {
                            ctx.fillRect(e.edges[i][j].x, e.edges[i][j].y, 1, 1);   
                        };
                        ctx.fill();
                        ctx.closePath();
                    }
                }
            }
        </script>
    </body>
</html>